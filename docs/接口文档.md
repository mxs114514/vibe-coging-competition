# AI 智能菜谱推荐系统 —— API 接口文档

> 版本：1.0  
> 最后更新：2026年1月  
> 基础地址：`http://localhost:8080/api`  
> 技术栈：Spring Boot 3.x + Spring Data JPA + MySQL 8.0

---

## 📌 通用说明

### 请求/响应格式

- 请求格式：`Content-Type: application/json`
- 响应格式：`application/json`
- 字符编码：`UTF-8`

### 统一响应结构

```json
{
  "code": 200,
  "message": "success",
  "data": { ... }
}
```

| 字段      | 类型     | 说明                                     |
|-----------|----------|------------------------------------------|
| `code`    | Integer  | 状态码：200成功，400参数错误，401未授权，500服务器错误 |
| `message` | String   | 提示信息                                 |
| `data`    | Object   | 响应数据（可为 null）                    |

### 错误码对照表

| 错误码 | 说明                |
|--------|---------------------|
| 200    | 成功                |
| 400    | 请求参数错误        |
| 401    | 未登录或 Token 失效 |
| 403    | 无权限访问          |
| 404    | 资源不存在          |
| 500    | 服务器内部错误      |

### 认证方式

采用 JWT Token 认证，登录成功后返回 Token，后续请求需在 Header 中携带：

```
Authorization: Bearer <token>
```

### 枚举编码对照表

#### 食材分类 (`category`)

| 编码 | 含义   |
|------|--------|
| 1    | 蔬菜   |
| 2    | 肉类   |
| 3    | 海鲜   |
| 4    | 主食   |
| 5    | 调味料 |

#### 菜系 (`cuisine`)

| 编码 | 含义   |
|------|--------|
| 1    | 中餐   |
| 2    | 西餐   |
| 3    | 日韩   |
| 4    | 东南亚 |

#### 基础味型 (`tasteBase`)

| 编码 | 含义   |
|------|--------|
| 1    | 甜     |
| 2    | 咸     |
| 3    | 酸     |
| 4    | 鲜     |
| 5    | 清淡   |
| 6    | 复合   |

#### 辣度等级 (`spiceLevel`)

| 编码 | 含义   |
|------|--------|
| 0    | 不辣   |
| 1    | 微辣   |
| 2    | 中辣   |
| 3    | 重辣   |
| 4    | 爆辣   |

#### 菜谱难度 (`difficulty`)

| 编码 | 含义   |
|------|--------|
| 1    | 简单   |
| 2    | 中等   |
| 3    | 复杂   |

#### 用户食材状态 (`status`)

| 编码 | 含义   |
|------|--------|
| 1    | 已有   |
| 2    | 缺少   |

---

## 🔐 用户认证模块

### 1. 获取验证码

**接口地址：** `POST /auth/captcha`

**说明：** 发送短信验证码。开发环境下，验证码会直接在响应 data 中返回以便测试。

**请求参数：**

```json
{
  "phone": "13800138000"
}
```

| 参数    | 类型   | 必填 | 说明              |
|---------|--------|------|-------------------|
| `phone` | String | 是   | 手机号，11 位数字 |

**响应示例：**

```json
{
  "code": 200,
  "message": "验证码已发送",
  "data": {
    "verifyCode": "123456"
  }
}
```

---

### 2. 用户登录

**接口地址：** `POST /auth/login`

**说明：** 使用手机号和验证码登录。如果手机号未注册，系统将自动创建账号。

**请求参数：**

```json
{
  "phone": "13800138000",
  "code": "123456"
}
```

| 参数    | 类型   | 必填 | 说明   |
|---------|--------|------|--------|
| `phone` | String | 是   | 手机号 |
| `code`  | String | 是   | 验证码 |

**响应示例：**

```json
{
  "code": 200,
  "message": "登录成功",
  "data": {
    "token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
    "expiresIn": 604800,
    "user": {
      "id": 1,
      "username": "用户_5839",
      "phone": "13800138000"
    }
  }
}
```

| 字段        | 说明                  |
|-------------|-----------------------|
| `token`     | JWT Token             |
| `expiresIn` | 过期时间（秒），7 天  |

---

### 3. 获取当前用户信息

**接口地址：** `GET /auth/me`

**请求头：** 需要 Authorization

**响应示例：**

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "id": 1,
    "username": "张三",
    "phone": "13800138000",
    "createdAt": "2026-01-29T10:30:00"
  }
}
```

---

## 🥬 食材管理模块

### 1. 获取用户冰箱食材列表

**接口地址：** `GET /user-ingredients`

**请求头：** 需要 Authorization

**请求参数（Query）：**

| 参数       | 类型    | 必填 | 说明                               |
|------------|---------|------|------------------------------------|
| `status`   | Integer | 否   | 状态筛选：1=已有，2=缺少            |
| `category` | Integer | 否   | 按分类筛选（1-5）                  |
| `keyword`  | String  | 否   | 搜索关键词（在冰箱已有食材中搜索） |

**响应示例：**

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "total": 8,
    "list": [
      {
        "id": 1,
        "ingredientId": 1,
        "name": "白菜",
        "category": 1,
        "categoryName": "蔬菜",
        "amount": 1.00,
        "unit": "颗",
        "status": 1,
        "statusName": "已有"
      },
      {
        "id": 2,
        "ingredientId": 5,
        "name": "鸡蛋",
        "category": 2,
        "categoryName": "肉类",
        "amount": 6.00,
        "unit": "个",
        "status": 1,
        "statusName": "已有"
      }
    ]
  }
}
```

---

### 2. 添加用户食材

**接口地址：** `POST /user-ingredients`

**请求头：** 需要 Authorization

**请求参数：**

```json
{
  "ingredientId": 1,
  "amount": 2,
  "unit": "颗",
  "status": 1
}
```

| 参数           | 类型    | 必填 | 说明                       |
|----------------|---------|------|----------------------------|
| `ingredientId` | Long    | 是   | 标准食材 ID                |
| `amount`       | Decimal | 是   | 数量                       |
| `unit`         | String  | 否   | 单位，默认取食材默认单位   |
| `status`       | Integer | 否   | 状态，默认 1（已有）       |

**响应示例：**

```json
{
  "code": 200,
  "message": "添加成功",
  "data": {
    "id": 3,
    "ingredientId": 1,
    "name": "白菜",
    "amount": 2.00,
    "unit": "颗",
    "status": 1
  }
}
```

---

### 3. 批量添加用户食材

**接口地址：** `POST /user-ingredients/batch`

**请求头：** 需要 Authorization

**请求参数：**

```json
{
  "ingredients": [
    { "ingredientId": 1, "amount": 2, "unit": "颗" },
    { "ingredientId": 5, "amount": 6, "unit": "个" },
    { "ingredientId": 10, "amount": 1, "unit": "袋" }
  ]
}
```

**响应示例：**

```json
{
  "code": 200,
  "message": "成功添加 3 种食材",
  "data": {
    "addedCount": 3
  }
}
```

---

### 4. 更新用户食材

**接口地址：** `PUT /user-ingredients/{id}`

**请求头：** 需要 Authorization

**路径参数：**

| 参数 | 类型 | 说明             |
|------|------|------------------|
| `id` | Long | 用户食材记录 ID  |

**请求参数：**

```json
{
  "amount": 3,
  "unit": "颗",
  "status": 1
}
```

**响应示例：**

```json
{
  "code": 200,
  "message": "更新成功",
  "data": {
    "id": 1,
    "ingredientId": 1,
    "name": "白菜",
    "amount": 3.00,
    "unit": "颗",
    "status": 1
  }
}
```

---

### 5. 删除用户食材

**接口地址：** `DELETE /user-ingredients/{id}`

**请求头：** 需要 Authorization

**路径参数：**

| 参数 | 类型 | 说明             |
|------|------|------------------|
| `id` | Long | 用户食材记录 ID  |

**响应示例：**

```json
{
  "code": 200,
  "message": "删除成功",
  "data": null
}
```

---

### 6. 批量删除用户食材

**接口地址：** `DELETE /user-ingredients/batch`

**请求头：** 需要 Authorization

**请求参数：**

```json
{
  "ids": [1, 2, 3]
}
```

**响应示例：**

```json
{
  "code": 200,
  "message": "成功删除 3 种食材",
  "data": {
    "deletedCount": 3
  }
}
```

---

## 🍳 菜谱管理模块

### 1. AI 生成菜谱

**接口地址：** `POST /recipes/generate`

**请求头：** 需要 Authorization

**说明：** 根据用户冰箱中的食材，调用 AI（通义千问）生成 3-5 道推荐菜谱。

**请求参数：**

```json
{
  "ingredients": ["番茄", "鸡蛋", "葱"],
  "filters": {
    "cuisine": 1,
    "maxCookingTime": 30,
    "difficulty": 1,
    "tasteBase": 2,
    "spiceLevel": 0
  }
}
```

| 参数                    | 类型     | 必填 | 说明                       |
|-------------------------|----------|------|----------------------------|
| `ingredients`           | String[] | 否   | 指定食材，为空则使用冰箱所有食材 |
| `filters`               | Object   | 否   | 筛选条件                   |
| `filters.cuisine`       | Integer  | 否   | 菜系编码（1-4）            |
| `filters.maxCookingTime`| Integer  | 否   | 最大烹饪时间（分钟）       |
| `filters.difficulty`    | Integer  | 否   | 难度编码（1-3）            |
| `filters.tasteBase`     | Integer  | 否   | 基础味型（1-6）            |
| `filters.spiceLevel`    | Integer  | 否   | 辣度等级（0-4）            |

**响应示例：**

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "recipes": [
      {
        "id": 101,
        "name": "番茄炒蛋",
        "cuisine": 1,
        "cuisineName": "中餐",
        "tasteBase": 4,
        "tasteBaseName": "鲜",
        "spiceLevel": 0,
        "spiceLevelName": "不辣",
        "cookingTimeMinutes": 15,
        "difficulty": 1,
        "difficultyName": "简单",
        "imageUrl": "https://images.unsplash.com/...",
        "ingredients": {
          "available": [
            { "name": "番茄", "quantity": 3, "unit": "个" },
            { "name": "鸡蛋", "quantity": 2, "unit": "个" }
          ],
          "needed": [
            { "name": "葱", "quantity": 1, "unit": "根" },
            { "name": "盐", "quantity": 5, "unit": "g" },
            { "name": "油", "quantity": 15, "unit": "ml" }
          ]
        },
        "steps": [
          "1. 番茄洗净切块，鸡蛋打入碗中加少许盐搅散",
          "2. 热锅倒油，油热后倒入蛋液，快速翻炒至凝固盛出",
          "3. 锅中再加少许油，放入番茄块翻炒出汁",
          "4. 加入适量盐调味，倒入炒好的鸡蛋",
          "5. 翻炒均匀，撒上葱花即可出锅"
        ],
        "nutritionAnalysis": {
          "calories": 180,
          "protein": 12.5,
          "carbs": 8.2,
          "fat": 10.3
        },
        "aiGenerated": true,
        "createdAt": "2026-01-29T10:30:00"
      },
      {
        "id": 102,
        "name": "蛋花汤",
        "cuisine": 1,
        "cuisineName": "中餐",
        "cookingTimeMinutes": 10,
        "difficulty": 1,
        "difficultyName": "简单",
        "imageUrl": "https://images.unsplash.com/...",
        "ingredients": {
          "available": [
            { "name": "鸡蛋", "quantity": 2, "unit": "个" },
            { "name": "番茄", "quantity": 1, "unit": "个" }
          ],
          "needed": [
            { "name": "葱", "quantity": 1, "unit": "根" },
            { "name": "盐", "quantity": 3, "unit": "g" }
          ]
        },
        "steps": [
          "1. 番茄切小块，鸡蛋打散备用",
          "2. 锅中加水烧开，放入番茄煮2分钟",
          "3. 将蛋液缓缓倒入，形成蛋花",
          "4. 加盐调味，撒上葱花即可"
        ],
        "aiGenerated": true
      }
    ],
    "generatedAt": "2026-01-29T10:30:00"
  }
}
```

---

### 2. 获取菜谱详情

**接口地址：** `GET /recipes/{id}`

**路径参数：**

| 参数 | 类型 | 说明     |
|------|------|----------|
| `id` | Long | 菜谱 ID  |

**响应示例：**

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "id": 101,
    "name": "番茄炒蛋",
    "cuisine": 1,
    "cuisineName": "中餐",
    "tasteBase": 4,
    "tasteBaseName": "鲜",
    "spiceLevel": 0,
    "spiceLevelName": "不辣",
    "cookingTimeMinutes": 15,
    "difficulty": 1,
    "difficultyName": "简单",
    "imageUrl": "https://images.unsplash.com/...",
    "ingredientsJson": [
      { "name": "番茄", "quantity": 3, "unit": "个" },
      { "name": "鸡蛋", "quantity": 2, "unit": "个" },
      { "name": "葱", "quantity": 1, "unit": "根" },
      { "name": "盐", "quantity": 5, "unit": "g" },
      { "name": "油", "quantity": 15, "unit": "ml" }
    ],
    "stepsText": "1. 番茄洗净切块...\n2. 热锅倒油...",
    "nutritionAnalysis": {
      "calories": 180,
      "protein": 12.5,
      "carbs": 8.2,
      "fat": 10.3
    },
    "aiGenerated": true,
    "createdAt": "2026-01-29T10:30:00"
  }
}
```

---

### 3. 收藏菜谱

**接口地址：** `POST /recipes/{id}/favorite`

**请求头：** 需要 Authorization

**路径参数：**

| 参数 | 类型 | 说明     |
|------|------|----------|
| `id` | Long | 菜谱 ID  |

**响应示例：**

```json
{
  "code": 200,
  "message": "收藏成功",
  "data": null
}
```

---

### 4. 取消收藏

**接口地址：** `DELETE /recipes/{id}/favorite`

**请求头：** 需要 Authorization

**响应示例：**

```json
{
  "code": 200,
  "message": "已取消收藏",
  "data": null
}
```

---

### 5. 获取收藏列表

**接口地址：** `GET /recipes/favorites`

**请求头：** 需要 Authorization

**请求参数（Query）：**

| 参数      | 类型    | 必填 | 说明               |
|-----------|---------|------|--------------------|
| `cuisine` | Integer | 否   | 按菜系筛选（1-4）  |
| `page`    | Integer | 否   | 页码，默认 1       |
| `size`    | Integer | 否   | 每页数量，默认 10  |

**响应示例：**

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "total": 12,
    "page": 1,
    "size": 10,
    "list": [
      {
        "id": 101,
        "name": "番茄炒蛋",
        "cuisine": 1,
        "cuisineName": "中餐",
        "cookingTimeMinutes": 15,
        "difficulty": 1,
        "difficultyName": "简单",
        "imageUrl": "https://...",
        "favoritedAt": "2026-01-15T14:30:00"
      }
    ]
  }
}
```

---

### 6. 获取生成历史记录

**接口地址：** `GET /recipes/history`

**请求头：** 需要 Authorization

**请求参数（Query）：**

| 参数   | 类型    | 必填 | 说明                     |
|--------|---------|------|--------------------------|
| `page` | Integer | 否   | 页码，默认 1             |
| `size` | Integer | 否   | 每页数量，默认 10        |

**响应示例：**

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "total": 25,
    "page": 1,
    "size": 10,
    "list": [
      {
        "id": 1,
        "ingredients": ["白菜", "鸡蛋", "番茄"],
        "recipesCount": 3,
        "recipes": [
          {
            "id": 101,
            "name": "番茄炒蛋"
          },
          {
            "id": 102,
            "name": "蛋花汤"
          }
        ],
        "generatedAt": "2026-01-29T10:30:00"
      }
    ]
  }
}
```

---

### 7. 根据历史记录重新生成

**接口地址：** `POST /recipes/regenerate/{historyId}`

**请求头：** 需要 Authorization

**路径参数：**

| 参数        | 类型 | 说明           |
|-------------|------|----------------|
| `historyId` | Long | 历史记录 ID    |

**响应：** 同"AI 生成菜谱"接口响应格式

---

## 🍽️ 餐桌模块（当前待做菜品）

### 1. 获取当前餐桌菜品列表

**接口地址：** `GET /table`

**请求头：** 需要 Authorization

**响应示例：**

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "total": 3,
    "list": [
      {
        "id": 1,
        "recipeId": 101,
        "name": "番茄炒蛋",
        "cuisine": 1,
        "cuisineName": "中餐",
        "cookingTimeMinutes": 15,
        "difficulty": 1,
        "difficultyName": "简单",
        "imageUrl": "https://...",
        "addedAt": "2026-01-29T10:30:00"
      }
    ]
  }
}
```

---

### 2. 添加菜品到餐桌

**接口地址：** `POST /table`

**请求头：** 需要 Authorization

**请求参数：**

```json
{
  "recipeId": 101
}
```

**响应示例：**

```json
{
  "code": 200,
  "message": "已添加到餐桌",
  "data": {
    "id": 1,
    "recipeId": 101,
    "name": "番茄炒蛋"
  }
}
```

---

### 3. 从餐桌移除菜品

**接口地址：** `DELETE /table/{id}`

**请求头：** 需要 Authorization

**路径参数：**

| 参数 | 类型 | 说明         |
|------|------|--------------|
| `id` | Long | 餐桌项 ID    |

**响应示例：**

```json
{
  "code": 200,
  "message": "已从餐桌移除",
  "data": null
}
```

---

### 4. 完成做菜（清空餐桌并扣减食材）

**接口地址：** `POST /table/complete`

**请求头：** 需要 Authorization

**说明：** 标记当前餐桌所有菜品已完成烹饪，自动扣减用户冰箱中对应食材的数量。

**响应示例：**

```json
{
  "code": 200,
  "message": "已完成做菜，食材已更新",
  "data": {
    "completedRecipes": 3,
    "updatedIngredients": [
      { "name": "番茄", "reducedAmount": 3, "remainingAmount": 2 },
      { "name": "鸡蛋", "reducedAmount": 4, "remainingAmount": 2 }
    ]
  }
}
```

---

### 5. 获取餐桌菜品详情（含食材检查）

**接口地址：** `GET /table/{id}/detail`

**请求头：** 需要 Authorization

**说明：** 获取餐桌中某道菜的详细信息，并检查用户冰箱中食材是否充足。

**响应示例：**

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "id": 1,
    "recipeId": 101,
    "name": "番茄炒蛋",
    "imageUrl": "https://...",
    "cookingTimeMinutes": 15,
    "difficulty": 1,
    "difficultyName": "简单",
    "ingredients": {
      "available": [
        { "name": "番茄", "quantity": 3, "unit": "个", "hasEnough": true },
        { "name": "鸡蛋", "quantity": 2, "unit": "个", "hasEnough": true }
      ],
      "needed": [
        { "name": "葱", "quantity": 1, "unit": "根", "hasEnough": false },
        { "name": "盐", "quantity": 5, "unit": "g", "hasEnough": true }
      ]
    },
    "steps": [
      "1. 番茄洗净切块，鸡蛋打入碗中加少许盐搅散",
      "2. 热锅倒油，油热后倒入蛋液，快速翻炒至凝固盛出",
      "3. 锅中再加少许油，放入番茄块翻炒出汁",
      "4. 加入适量盐调味，倒入炒好的鸡蛋",
      "5. 翻炒均匀，撒上葱花即可出锅"
    ],
    "isSufficient": false,
    "missingIngredients": [
      { "name": "葱", "quantity": 1, "unit": "根" }
    ]
  }
}
```

---

## 🛒 购物清单模块

### 1. 获取购物清单

**接口地址：** `GET /cart`

**请求头：** 需要 Authorization

**响应示例：**

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "total": 5,
    "list": [
      {
        "id": 1,
        "ingredientId": 15,
        "name": "葱",
        "category": 1,
        "categoryName": "蔬菜",
        "quantity": 2,
        "unit": "根",
        "fromRecipes": ["番茄炒蛋", "蛋花汤"],
        "addedAt": "2026-01-29T10:30:00"
      },
      {
        "id": 2,
        "ingredientId": 20,
        "name": "盐",
        "category": 5,
        "categoryName": "调味料",
        "quantity": 1,
        "unit": "袋",
        "fromRecipes": null,
        "addedAt": "2026-01-29T11:00:00"
      }
    ],
    "categorized": {
      "蔬菜": [{ "name": "葱", "quantity": 2, "unit": "根" }],
      "调味料": [{ "name": "盐", "quantity": 1, "unit": "袋" }]
    }
  }
}
```

---

### 2. 添加购物清单项

**接口地址：** `POST /cart`

**请求头：** 需要 Authorization

**请求参数：**

```json
{
  "ingredientId": 15,
  "quantity": 2,
  "unit": "根",
  "fromRecipeId": 101
}
```

| 参数           | 类型    | 必填 | 说明                   |
|----------------|---------|------|------------------------|
| `ingredientId` | Long    | 是   | 标准食材 ID            |
| `quantity`     | Decimal | 是   | 数量                   |
| `unit`         | String  | 否   | 单位                   |
| `fromRecipeId` | Long    | 否   | 来源菜谱 ID（可选）    |

**响应示例：**

```json
{
  "code": 200,
  "message": "已添加到购物清单",
  "data": {
    "id": 3,
    "name": "葱",
    "quantity": 2,
    "unit": "根"
  }
}
```

---

### 3. 从菜谱自动生成购物清单

**接口地址：** `POST /cart/from-recipes`

**请求头：** 需要 Authorization

**说明：** 根据餐桌上的菜品，自动将缺少的食材添加到购物清单。

**请求参数：**

```json
{
  "recipeIds": [101, 102, 103]
}
```

**响应示例：**

```json
{
  "code": 200,
  "message": "已生成购物清单",
  "data": {
    "addedCount": 5,
    "items": [
      { "name": "葱", "quantity": 2, "unit": "根" },
      { "name": "油", "quantity": 1, "unit": "瓶" }
    ]
  }
}
```

---

### 4. 更新购物清单项数量

**接口地址：** `PUT /cart/{id}`

**请求头：** 需要 Authorization

**请求参数：**

```json
{
  "quantity": 3
}
```

**响应示例：**

```json
{
  "code": 200,
  "message": "更新成功",
  "data": {
    "id": 1,
    "name": "葱",
    "quantity": 3,
    "unit": "根"
  }
}
```

---

### 5. 删除购物清单项

**接口地址：** `DELETE /cart/{id}`

**请求头：** 需要 Authorization

**响应示例：**

```json
{
  "code": 200,
  "message": "已删除",
  "data": null
}
```

---

### 6. 清空购物清单

**接口地址：** `DELETE /cart/clear`

**请求头：** 需要 Authorization

**响应示例：**

```json
{
  "code": 200,
  "message": "购物清单已清空",
  "data": null
}
```

---

### 7. 完成购买（添加到冰箱）

**接口地址：** `POST /cart/complete`

**请求头：** 需要 Authorization

**说明：** 标记购物清单中的食材已购买，自动添加到用户冰箱中。

**请求参数：**

```json
{
  "ids": [1, 2, 3]
}
```

| 参数  | 类型   | 必填 | 说明                           |
|-------|--------|------|--------------------------------|
| `ids` | Long[] | 否   | 要完成的项 ID，为空则完成全部  |

**响应示例：**

```json
{
  "code": 200,
  "message": "已添加到冰箱",
  "data": {
    "completedCount": 3,
    "addedToFridge": [
      { "name": "葱", "quantity": 2, "unit": "根" },
      { "name": "盐", "quantity": 1, "unit": "袋" },
      { "name": "油", "quantity": 1, "unit": "瓶" }
    ]
  }
}
```

---

## 📤 导出功能

### 1. 导出菜谱为图片

**接口地址：** `GET /recipes/{id}/export/image`

**请求头：** 需要 Authorization

**响应：** 返回图片文件（`image/png`）

---

### 2. 导出菜谱为文本

**接口地址：** `GET /recipes/{id}/export/text`

**请求头：** 需要 Authorization

**响应示例：**

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "text": "【番茄炒蛋】\n\n📝 所需食材：\n- 番茄 3个\n- 鸡蛋 2个\n- 葱 1根\n- 盐 5g\n- 油 15ml\n\n👨‍🍳 烹饪步骤：\n1. 番茄洗净切块，鸡蛋打入碗中加少许盐搅散\n2. 热锅倒油，油热后倒入蛋液，快速翻炒至凝固盛出\n...\n\n⏱️ 烹饪时间：15分钟\n📊 难度：简单"
  }
}
```

---

## 🔧 系统接口

### 1. 健康检查

**接口地址：** `GET /health`

**响应示例：**

```json
{
  "code": 200,
  "message": "success",
  "data": {
    "status": "UP",
    "database": "UP",
    "aiService": "UP",
    "timestamp": "2026-01-29T10:30:00"
  }
}
```

---

## 📋 接口清单汇总

| 模块     | 方法   | 接口路径                          | 说明                   | 认证 |
|----------|--------|-----------------------------------|------------------------|------|
| **认证** | POST   | /auth/captcha                     | 获取验证码             | ❌   |
|          | POST   | /auth/login                       | 用户登录（自动注册）   | ❌   |
|          | GET    | /auth/me                          | 获取当前用户信息       | ✅   |
| **食材** | GET    | /user-ingredients                 | 获取用户冰箱食材       | ✅   |
|          | POST   | /user-ingredients                 | 添加用户食材           | ✅   |
|          | POST   | /user-ingredients/batch           | 批量添加食材           | ✅   |
|          | PUT    | /user-ingredients/{id}            | 更新用户食材           | ✅   |
|          | DELETE | /user-ingredients/{id}            | 删除用户食材           | ✅   |
|          | DELETE | /user-ingredients/batch           | 批量删除食材           | ✅   |
| **菜谱** | POST   | /recipes/generate                 | AI 生成菜谱            | ✅   |
|          | GET    | /recipes/{id}                     | 获取菜谱详情           | ❌   |
|          | POST   | /recipes/{id}/favorite            | 收藏菜谱               | ✅   |
|          | DELETE | /recipes/{id}/favorite            | 取消收藏               | ✅   |
|          | GET    | /recipes/favorites                | 获取收藏列表           | ✅   |
|          | GET    | /recipes/history                  | 获取生成历史           | ✅   |
|          | POST   | /recipes/regenerate/{historyId}   | 根据历史重新生成       | ✅   |
| **餐桌** | GET    | /table                            | 获取餐桌菜品列表       | ✅   |
|          | POST   | /table                            | 添加菜品到餐桌         | ✅   |
|          | DELETE | /table/{id}                       | 从餐桌移除菜品         | ✅   |
|          | POST   | /table/complete                   | 完成做菜               | ✅   |
|          | GET    | /table/{id}/detail                | 获取餐桌菜品详情       | ✅   |
| **购物** | GET    | /cart                             | 获取购物清单           | ✅   |
|          | POST   | /cart                             | 添加购物清单项         | ✅   |
|          | POST   | /cart/from-recipes                | 从菜谱生成购物清单     | ✅   |
|          | PUT    | /cart/{id}                        | 更新购物清单项         | ✅   |
|          | DELETE | /cart/{id}                        | 删除购物清单项         | ✅   |
|          | DELETE | /cart/clear                       | 清空购物清单           | ✅   |
|          | POST   | /cart/complete                    | 完成购买               | ✅   |
| **导出** | GET    | /recipes/{id}/export/image        | 导出菜谱为图片         | ✅   |
|          | GET    | /recipes/{id}/export/text         | 导出菜谱为文本         | ✅   |
| **系统** | GET    | /health                           | 健康检查               | ❌   |

---

## 📝 补充说明

### 分页参数说明

分页接口统一使用以下参数：

| 参数   | 类型    | 默认值 | 说明         |
|--------|---------|--------|--------------|
| `page` | Integer | 1      | 页码（从1开始）|
| `size` | Integer | 10/20  | 每页数量     |

### 时间格式

所有时间字段统一采用 ISO 8601 格式：`2026-01-29T10:30:00`

### 数据验证

- 手机号：11 位数字，正则 `^1[3-9]\d{9}$`
- 用户名：2-20 个字符

### 前端对接建议

1. 使用 Axios 作为 HTTP 客户端
2. 封装统一的请求拦截器添加 Token
3. 封装统一的响应拦截器处理错误
4. 使用 Pinia 管理用户登录状态和 Token 存储

```typescript
// services/api.ts 示例
import axios from 'axios'

const api = axios.create({
  baseURL: import.meta.env.VITE_API_BASE_URL || 'http://localhost:8080/api',
  timeout: 30000
})

api.interceptors.request.use((config) => {
  const token = localStorage.getItem('token')
  if (token) {
    config.headers.Authorization = `Bearer ${token}`
  }
  return config
})

api.interceptors.response.use(
  (response) => response.data,
  (error) => {
    if (error.response?.status === 401) {
      // 跳转登录页
    }
    return Promise.reject(error)
  }
)

export default api
```

---

> 📌 **文档维护说明**  
> 本文档随项目迭代更新，如有接口变更请及时同步修改。
